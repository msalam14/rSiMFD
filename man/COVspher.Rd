% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rSiMFD.R
\name{COVspher}
\alias{COVspher}
\title{Calculate the spherical covariance at a given distance when range, nugget and
total variance are known.}
\usage{
COVspher(h, Cov0, range, nugget)
}
\arguments{
\item{h}{the spatial distance where covariance to be calculated}

\item{Cov0}{a scalar representing the total variance}

\item{range}{a scalar representing the range parameter}

\item{nugget}{a scalar representing the nugget parameter}
}
\value{
a scalar representing the value of spatial covariance
}
\description{
Calculate the spherical covariance at a given distance when range, nugget and
total variance are known.
}
\examples{
Cov0  <- 1.0     # total variance (sill)
rng <- 0.4     # range parameter
ngt <- 0.2    # nugget proportion

# Covariance at specific distances
h_vals<- c(0, rng/2, rng, 1.5*rng)
names(h_vals) <- c("h=0", "h=rng/2", "h=rng", "h>rng")

cov_val <- sapply(h_vals, function(h) COVspher(h, Cov0, rng, ngt))
print(round(cov_val, 4))

# Covariance function
h_val_seq  <- seq(0, 2*rng, length.out = 300)
cov_val_seq <- sapply(h_val_seq, function(h) COVspher(h, Cov0, rng, ngt))

# Plotting the resulting covariance
plot(h_val_seq, cov_val_seq, type = "l", lwd = 2,
     xlab = "Distance h", ylab = "Spherical covariance",
     main = "Spherical covariance with nugget")
abline(v = range, lty = 2)  # mark range
legend("topright",
       legend = c(paste0("range = ", range),
                  paste0("nugget = ", nugget),
                  paste0("Cov0 = ", Cov0)),
       bty = "n")

}
