% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rSiMFD.R
\name{corSpatialVal}
\alias{corSpatialVal}
\title{Calculate different spatial autocorrelation functions, Spherical, Gaussian 
and Exponential, at a given distance, assuming range and nugget parameters are known.}
\usage{
corSpatialVal(r, d, nugget = 0, type = "spherical")
}
\arguments{
\item{r}{the spatial distance where covariance to be calculated}

\item{d}{a scalar representing the range parameter}

\item{nugget}{a scalar representing the nugget parameter}

\item{type}{a character, spherical or gaussian, that specifies which type of 
spatial correlation needs to be calculated. If anything else is chosen it
computes the exponential correlation.}
}
\value{
a scalar representing the value of spatial correlation
}
\description{
Calculate different spatial autocorrelation functions, Spherical, Gaussian 
and Exponential, at a given distance, assuming range and nugget parameters are known.
}
\examples{
# Parameters
d       <- 0.5    # range
nugget  <- 0.2    # nugget proportion
types   <- c("spherical", "gaussian", "exponential")

# Sanity checks at specific distances
r_checks <- c(0, d/2, d, 1.5*d)
names(r_checks) <- c("r=0", "r=d/2", "r=d", "r> d")

check_mat <- sapply(types, function(tp) {
  sapply(r_checks, function(r) corSpatialVal(r, d, nugget = nugget, type = tp))
})
print(round(check_mat, 4))

# Vectorized curve over distance
r_vals <- seq(0, 2*d, length.out = 400)

corr_sph  <- corSpatialVal(r_vals, d, nugget = nugget, type = "spherical")
corr_gau  <- corSpatialVal(r_vals, d, nugget = nugget, type = "gaussian")
corr_exp  <- corSpatialVal(r_vals, d, nugget = nugget, type = "exponential") # anything else defaults to exponential

# Plot the three correlation functions
df_plot <- tibble::tibble(
  r = r_vals,
  Spherical  = corr_sph,
  Gaussian   = corr_gau,
  Exponential= corr_exp
) \%>\%
  pivot_longer(cols = -r, names_to = "Type", values_to = "Correlation")

ggplot(df_plot, aes(x = r, y = Correlation, color = Type)) +
  geom_line(linewidth = 1) +
  geom_vline(xintercept = d, linetype = 2) +
  labs(
    x = "Distance r",
    y = "Spatial correlation",
    title = "Spherical vs Gaussian vs Exponential (with nugget)",
    subtitle = paste0("range d = ", d, "   |   nugget = ", nugget),
    color = NULL
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = "top")
}
